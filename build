# Telgram env setup
export BOT_MSG_URL="https://api.telegram.org/bot"$bot_api"/sendMessage"

tg_post_msg() {
 curl -s -X POST "$BOT_MSG_URL" -d chat_id="@D4rkKnight21_ci" \
 -d "parse_mode=html" \
 -d text="$1"
}

#!/bin/bash
cd /tmp/rom 

source build/envsetup.sh && export SELINUX_IGNORE_NEVERALLOWS=true && lunch cafex_platina-userdebug && export SKIP_API_CHECKS=true && export SKIP_API_CHECKS=true

up(){
	#curl --upload-file $1 https://transfer.sh/$(basename $1); echo
	mkdir -p ~/.config/rclone
	echo "$rclone_config" > ~/.config/rclone/rclone.conf 
	time rclone copy $1 up:Platina -P
}

tg(){ 
	curl -s "https://api.telegram.org/bot"$bot_api"/sendmessage" --data "text=$msg&chat_id=@D4rkKnight21_CI"
}


tg_post_msg "Starting Build https://cirrus-ci.com/build/$CIRRUS_BUILD_ID" "@D4rkKnight21_ci"
make api-stubs-docs && make system-api-stubs-docs && make test-api-stubs-docs && make sepolicy && m cafex -j$(nproc --all)

        && send_zip=$(up out/target/product/platina/*zip) && tg_post_msg "Build Succeed!
$send_zip" \
        || tg_post_msg "Build Failed" "@D4rkKnight21_ci"
